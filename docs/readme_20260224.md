# XAUUSD EA Collection (EA0 – EA4)

Full technical breakdown for internal use & optimization tracking.

---

# EA0 – MTF EMA Pullback (Risk-Based Core)

## Logic Structure

**Trend Filter**

- M15 EMA(50/200)
- H1 EMA(50/200)
- Both must align (BULL or BEAR)

**Entry (M5)**

- EMA(20) pullback logic
- BUY:
  - Trend = BULL
  - Candle[2] close < EMA20
  - Candle[1] close > EMA20
- SELL:
  - Trend = BEAR
  - Candle[2] close > EMA20
  - Candle[1] close < EMA20

**Risk Model**

- Dynamic lot via `RiskPct`
- Lot = balance × RiskPct / SL value
- Auto-normalized to broker constraints

**Protections**

- Spread filter (`MaxSpreadPoints`)
- `MaxPositions`
- MagicNumber isolation

**Exit Logic**

- Early profit exit after `EARLY_MINUTES` if profit > 0
- Hard time exit at `MAX_MINUTES`
- Fixed SL/TP

**Behavior Profile**

- High trade frequency
- Pullback continuation model
- Sensitive to chop
- Equity curve depends heavily on early exit tuning

---

# EA1 – Break + Momentum Filtered Pullback

Evolution of EA0 with structure confirmation.

## Differences vs EA0

**Entry Upgrade**

- Previous candle must touch EMA20 (wick interaction)
- Current candle must break previous high/low
- Body size filter (`MinBodyPts`)
- Uses structure breakout instead of simple EMA cross

**Risk**

- Still dynamic (RiskPct)
- Same spread + max position control

**Exit**

- Early profit close (default longer hold)
- Time exit

**Behavior Profile**

- Fewer trades than EA0
- Higher quality entries
- More robust during trending sessions
- Less overtrading in micro pullbacks

---

# EA2 – Minimal Momentum + Hard SL Block

Control-focused experimental EA.

## Entry

- BUY if Close[1] > Close[2]
- SELL if Close[1] < Close[2]
- No trend filter
- No structure logic

## Risk

- Fixed lot only

## Protection Layer

- Tracks SL via history scanning
- `SL_TO_STOP` triggers trading block
- Block mode:
  - Per session (Asia/Europe/America)
  - Or per day
- Auto reset on new block key

## Exit

- Time-based only
- Standard SL/TP

## Behavior Profile

- High noise
- Good for studying SL clustering
- Useful template for risk shutoff logic

---

# EA3 – Structured Pullback + Session SL Guard

Most balanced architecture.

## Trend Filter

- M15 EMA(50/200)
- H1 EMA(50/200)
- Alignment required

## Entry

- Uses CLOSED candles only
- Candle[2] body filter (`MinBodyPts`)
- Pullback through EMA20
- Confirmation via next candle break of EMA

## Risk

- Fixed lot
- Spread filter
- MaxPositions
- Session SL limit (`SessionSL_Limit`)

## SL Detection

- Uses `OnTradeTransaction`
- Counts losing exits (profit < 0)
- Increments session SL counter

## Exit

- Time-based exit
- Standard SL/TP

## Behavior Profile

- Controlled trade frequency
- Reduced revenge trading
- More stable than EA0/EA1
- Better suited for prop-style constraints

---

# EA4 – EMA200 Momentum + Exposure Lock

Simplified but strict.

## Trend Filter

- Single EMA200 (M5)

## Entry

- Strong body filter (≥ 300 points)
- Momentum confirmation:
  - BUY: close > EMA200 AND > previous close
  - SELL: close < EMA200 AND < previous close
- 1 position at a time only

## Risk

- Fixed lot
- Hard exposure limit (single trade)

## Protection

- SL counter (history-based)
- Blocks after N SL hits
- Reset per session/day

## Exit

- Time-based
- Standard SL/TP

## Behavior Profile

- Low frequency
- Anti-overtrading
- Designed for capital preservation

---

# Architectural Comparison

| EA  | Trend Filter       | Entry Model           | Lot Type   | Early Exit | Session SL Stop | Max Positions |
| --- | ------------------ | --------------------- | ---------- | ---------- | --------------- | ------------- |
| EA0 | M15 + H1 EMA50/200 | EMA20 cross pullback  | Risk-based | Yes        | No              | Yes           |
| EA1 | M15 + H1 EMA50/200 | Break + body filter   | Risk-based | Yes        | No              | Yes           |
| EA2 | None               | Close momentum        | Fixed      | No         | Yes             | No            |
| EA3 | M15 + H1 EMA50/200 | Pullback + structure  | Fixed      | No         | Yes             | Yes           |
| EA4 | EMA200 (M5)        | Strong momentum break | Fixed      | No         | Yes             | 1 only        |

---

# Strategic Evolution

EA0 → Raw pullback  
EA1 → Add structure confirmation  
EA2 → Add hard risk shutdown logic  
EA3 → Combine structure + session SL control  
EA4 → Simplify entry, maximize protection

---

# Deployment Guidance

Research Mode:

- EA0
- EA1

Controlled Live Environment:

- EA3

Capital Preservation / Prop Rules:

- EA4

Risk Logic Testing Only:

- EA2
